# 📊 Citea 后台管理系统使用说明

## ✅ 已实现功能

### 核心功能：
1. ✅ **独立的管理系统** - 完全隔离于用户环境
2. ✅ **管理员认证** - 独立的登录系统
3. ✅ **数据概览** - 实时统计关键指标
4. ✅ **用户管理** - 查看和管理所有用户
5. ✅ **权限保护** - 所有后台路由都需要管理员权限

---

## 🚀 快速开始

### 1. 配置环境变量

在 `.env.local` 或 Vercel 环境变量中添加：

```bash
# 管理员密码（必须修改！）
ADMIN_PASSWORD=your-secure-password-here

# 管理员 JWT 密钥（可选，有默认值）
ADMIN_JWT_SECRET=your-admin-jwt-secret

# 已有配置
REDIS_URL=rediss://...
BREVO_API_KEY=...
```

⚠️ **重要**: 生产环境必须修改 `ADMIN_PASSWORD`！

### 2. 访问后台

访问：`http://localhost:3000/admin` (本地) 或 `https://your-domain.com/admin` (生产)

首次访问会自动跳转到登录页面。

### 3. 登录

使用配置的管理员密码登录。

---

## 📋 功能说明

### 数据概览 (`/admin/dashboard`)

显示关键指标：
- 总用户数
- 今日新注册用户
- 今日活跃用户
- 本月活跃用户
- 付费用户数
- 留存率

数据每 30 秒自动刷新。

### 用户管理 (`/admin/users`)

功能：
- 查看所有注册用户
- 搜索用户（按邮箱或姓名）
- 查看用户状态（已验证/未验证）
- 查看注册时间和最后登录时间
- 查看用户计划（免费/专业/高级）
- 点击"查看详情"查看详细信息

### 行为分析 (`/admin/analytics`)

**开发中** - 将显示：
- 页面访问统计
- 功能使用分析
- 用户行为路径

### 付费管理 (`/admin/payments`)

**开发中** - 将显示：
- 付费用户列表
- 订阅统计
- 收入数据

### 数据报表 (`/admin/reports`)

**开发中** - 将显示：
- 详细数据报表
- 数据导出功能

### 系统设置 (`/admin/settings`)

**开发中** - 将包括：
- 系统配置
- 管理员管理

---

## 🔐 安全说明

### 权限保护

- ✅ 所有 `/admin/*` 路由都需要管理员认证
- ✅ 未登录会自动跳转到 `/admin/login`
- ✅ 使用独立的认证系统（不影响用户系统）

### 安全建议

1. **修改默认密码**
   ```bash
   ADMIN_PASSWORD=your-very-secure-password-123!
   ```

2. **使用强密码**
   - 至少 16 个字符
   - 包含大小写字母、数字、特殊字符

3. **定期更换密码**
   - 建议每 3 个月更换一次

4. **生产环境配置**
   - 使用环境变量存储密码
   - 不要在代码中硬编码

---

## 🎨 界面特点

### 设计
- ✅ 专业的后台管理界面
- ✅ 深色主题的导航栏
- ✅ 响应式设计（支持移动端）
- ✅ 清晰的数据展示

### 用户体验
- ✅ 实时数据更新
- ✅ 快速搜索和筛选
- ✅ 清晰的状态指示
- ✅ 友好的错误提示

---

## 📊 数据说明

### 统计数据来源

- **用户数据**: 从 Redis 数据库读取
- **统计计算**: 实时计算
- **更新频率**: 30 秒自动刷新

### 指标定义

- **总用户数**: 所有注册用户
- **今日新注册**: 今天创建的账户
- **今日活跃**: 今天登录过的用户
- **本月活跃**: 本月登录过的用户
- **付费用户**: 计划不是 "free" 的用户
- **留存率**: 7 天留存率（简化版）

---

## 🛠️ 技术架构

### 路由结构

```
/admin
  /login          # 登录页面
  /dashboard      # 数据概览
  /users          # 用户管理
  /users/[id]     # 用户详情（开发中）
  /analytics      # 行为分析（开发中）
  /payments       # 付费管理（开发中）
  /reports        # 数据报表（开发中）
  /settings       # 系统设置（开发中）
```

### 认证流程

1. 访问 `/admin/*` → 检查是否有 `admin_auth` cookie
2. 无 cookie → 跳转到 `/admin/login`
3. 输入密码 → 验证 → 设置 cookie
4. 有 cookie → 验证 JWT → 允许访问

### 数据 API

- `GET /api/admin/stats` - 获取统计数据
- `GET /api/admin/users` - 获取用户列表
- `POST /api/admin/login` - 管理员登录
- `POST /api/admin/logout` - 管理员退出

---

## 🚧 后续开发计划

### 优先级高
- [ ] 用户详情页面
- [ ] 图表可视化（使用 Recharts）
- [ ] 数据追踪 API
- [ ] 用户行为记录

### 优先级中
- [ ] 数据导出功能
- [ ] 高级搜索和筛选
- [ ] 批量操作
- [ ] 数据报表生成

### 优先级低
- [ ] 管理员管理（多管理员）
- [ ] 操作日志
- [ ] 数据备份

---

## ❓ 常见问题

### Q: 忘记管理员密码怎么办？

A: 修改环境变量 `ADMIN_PASSWORD` 并重新部署。

### Q: 能否禁用后台系统？

A: 可以通过移除环境变量 `ADMIN_PASSWORD` 来禁用登录。

### Q: 数据和用户系统是分离的吗？

A: 是的，完全独立。管理员系统不影响用户正常使用。

### Q: 如何添加多个管理员？

A: 当前版本只支持单个管理员。多管理员功能在开发计划中。

---

## 📝 更新日志

### v1.0.0 (当前版本)
- ✅ 基础架构完成
- ✅ 管理员认证系统
- ✅ 数据概览页面
- ✅ 用户管理页面
- ✅ 数据统计 API

---

**后台管理系统已可以使用！访问 `/admin` 开始使用。** 🎉

