# ğŸš€ Citea éƒ¨ç½²æ£€æŸ¥æ¸…å•

## éƒ¨ç½²å‰å‡†å¤‡ (Pre-deployment)

### 1. ä»£ç å‡†å¤‡
- [ ] æ‰€æœ‰åŠŸèƒ½å·²æµ‹è¯•å¹¶æ­£å¸¸å·¥ä½œ
- [ ] å·²ä¿®å¤æ‰€æœ‰å·²çŸ¥çš„ bug
- [ ] ä»£ç å·²æäº¤åˆ° Git ä»“åº“
- [ ] ç§»é™¤æ‰€æœ‰è°ƒè¯•ä»£ç å’Œ console.log
- [ ] æ›´æ–°ç‰ˆæœ¬å· (package.json)

### 2. ç¯å¢ƒå˜é‡é…ç½®
- [ ] å·²åˆ›å»º `.env.local` æ–‡ä»¶ (æœ¬åœ°)
- [ ] å·²è®¾ç½®ç”Ÿäº§ç¯å¢ƒå˜é‡ (Vercel/æœåŠ¡å™¨)
- [ ] **JWT_SECRET** å·²è®¾ç½®ä¸ºå¼ºå¯†é’¥ (è‡³å°‘ 32 å­—ç¬¦)
- [ ] **NODE_ENV** è®¾ç½®ä¸º `production`
- [ ] æ•°æ®åº“è¿æ¥å·²é…ç½® (Redis/Vercel KV)

### 3. æ•°æ®åº“é…ç½®
- [ ] é€‰æ‹©æ•°æ®åº“æ–¹æ¡ˆ (Redis/Vercel KV)
- [ ] æ•°æ®åº“è¿æ¥å·²æµ‹è¯•
- [ ] è¿è¡Œæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
  ```bash
  node scripts/init-database.js
  ```
- [ ] åˆ›å»ºæµ‹è¯•ç”¨æˆ·å¹¶éªŒè¯ç™»å½•
- [ ] å¤‡ä»½ç°æœ‰æ•°æ® (å¦‚æœ‰)

### 4. å®‰å…¨æ£€æŸ¥
- [ ] JWT å¯†é’¥ä¸æ˜¯é»˜è®¤å€¼
- [ ] ç”Ÿäº§ç¯å¢ƒä¸ä½¿ç”¨æ–‡ä»¶å­˜å‚¨
- [ ] HTTPS å·²å¯ç”¨
- [ ] CORS é…ç½®æ­£ç¡®
- [ ] Cookie è®¾ç½® secure æ ‡å¿—
- [ ] æ•æ„Ÿä¿¡æ¯ä¸åœ¨ä»£ç ä¸­ç¡¬ç¼–ç 
- [ ] `.env.local` å·²åŠ å…¥ `.gitignore`

---

## Vercel éƒ¨ç½²æ­¥éª¤

### æ–¹æ¡ˆ A: é€šè¿‡ Vercel Dashboard éƒ¨ç½²

#### æ­¥éª¤ 1: å‡†å¤‡ä»£ç ä»“åº“
```bash
# ç¡®ä¿ä»£ç å·²æ¨é€åˆ° GitHub
git add .
git commit -m "Ready for production deployment"
git push origin main
```

#### æ­¥éª¤ 2: å¯¼å…¥é¡¹ç›®åˆ° Vercel
1. è®¿é—® [vercel.com](https://vercel.com/)
2. ç‚¹å‡» "Add New Project"
3. é€‰æ‹©ä½ çš„ GitHub ä»“åº“
4. ç‚¹å‡» "Import"

#### æ­¥éª¤ 3: é…ç½®ç¯å¢ƒå˜é‡
åœ¨ Vercel é¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡:

```bash
# å¿…éœ€å˜é‡
JWT_SECRET=your_production_jwt_secret_here
NODE_ENV=production

# å¦‚æœä½¿ç”¨ OpenAI (å¯é€‰)
OPENAI_API_KEY=your_openai_key_here
```

#### æ­¥éª¤ 4: æ·»åŠ  Vercel KV æ•°æ®åº“
1. åœ¨ Vercel é¡¹ç›®é¡µé¢ï¼Œç‚¹å‡» "Storage" æ ‡ç­¾
2. ç‚¹å‡» "Create Database"
3. é€‰æ‹© "KV (Redis)"
4. ç‚¹å‡» "Create"
5. ç‚¹å‡» "Connect to Project" è¿æ¥åˆ°ä½ çš„é¡¹ç›®
6. Vercel ä¼šè‡ªåŠ¨æ·»åŠ  KV ç›¸å…³çš„ç¯å¢ƒå˜é‡

#### æ­¥éª¤ 5: éƒ¨ç½²
1. ç‚¹å‡» "Deploy" æŒ‰é’®
2. ç­‰å¾…éƒ¨ç½²å®Œæˆ
3. è®¿é—®ç”Ÿæˆçš„ URL æµ‹è¯•ç½‘ç«™

#### æ­¥éª¤ 6: é…ç½®è‡ªå®šä¹‰åŸŸå (å¯é€‰)
1. åœ¨é¡¹ç›®è®¾ç½®ä¸­ç‚¹å‡» "Domains"
2. æ·»åŠ ä½ çš„åŸŸå
3. æŒ‰ç…§æç¤ºé…ç½® DNS è®°å½•

### æ–¹æ¡ˆ B: é€šè¿‡ Vercel CLI éƒ¨ç½²

#### æ­¥éª¤ 1: å®‰è£… Vercel CLI
```bash
npm install -g vercel
```

#### æ­¥éª¤ 2: ç™»å½• Vercel
```bash
vercel login
```

#### æ­¥éª¤ 3: éƒ¨ç½²
```bash
# é¦–æ¬¡éƒ¨ç½²
vercel

# ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
vercel --prod
```

#### æ­¥éª¤ 4: è®¾ç½®ç¯å¢ƒå˜é‡
```bash
vercel env add JWT_SECRET production
# è¾“å…¥ä½ çš„ JWT å¯†é’¥

vercel env add NODE_ENV production
# è¾“å…¥: production
```

---

## è‡ªæ‰˜ç®¡éƒ¨ç½²æ­¥éª¤ (Docker)

### æ­¥éª¤ 1: å‡†å¤‡ Redis æ•°æ®åº“

**é€‰é¡¹ A: ä½¿ç”¨äº‘æœåŠ¡ Redis**
- Upstash: https://upstash.com/
- Railway: https://railway.app/
- Redis Cloud: https://redis.com/

**é€‰é¡¹ B: è‡ªæ‰˜ç®¡ Redis**
```bash
docker run -d \
  --name citea-redis \
  -p 6379:6379 \
  -v redis-data:/data \
  redis:latest
```

### æ­¥éª¤ 2: åˆ›å»º Dockerfile

```dockerfile
FROM node:18-alpine

WORKDIR /app

COPY package*.json ./
RUN npm ci --only=production

COPY . .
RUN npm run build

EXPOSE 3000

CMD ["npm", "start"]
```

### æ­¥éª¤ 3: åˆ›å»º docker-compose.yml

```yaml
version: '3.8'

services:
  app:
    build: .
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      - JWT_SECRET=${JWT_SECRET}
      - REDIS_URL=redis://redis:6379
    depends_on:
      - redis

  redis:
    image: redis:latest
    volumes:
      - redis-data:/data

volumes:
  redis-data:
```

### æ­¥éª¤ 4: éƒ¨ç½²
```bash
# æ„å»ºå¹¶å¯åŠ¨
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f app

# åœæ­¢
docker-compose down
```

---

## éƒ¨ç½²åéªŒè¯

### 1. åŠŸèƒ½æµ‹è¯•
- [ ] ä¸»é¡µæ­£å¸¸åŠ è½½
- [ ] ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½æ­£å¸¸
- [ ] ç”¨æˆ·ç™»å½•åŠŸèƒ½æ­£å¸¸
- [ ] Dashboard é¡µé¢æ­£å¸¸æ˜¾ç¤º
- [ ] é€€å‡ºç™»å½•åŠŸèƒ½æ­£å¸¸
- [ ] AI åŠŸèƒ½æ­£å¸¸ (å¦‚æœé…ç½®äº†)

### 2. æ€§èƒ½æµ‹è¯•
- [ ] é¡µé¢åŠ è½½æ—¶é—´ < 3 ç§’
- [ ] API å“åº”æ—¶é—´ < 500ms
- [ ] æ•°æ®åº“æŸ¥è¯¢æ­£å¸¸
- [ ] æ— å†…å­˜æ³„æ¼

### 3. å®‰å…¨æµ‹è¯•
- [ ] HTTPS æ­£å¸¸å·¥ä½œ
- [ ] Cookie è®¾ç½®æ­£ç¡®
- [ ] JWT è¿‡æœŸæ—¶é—´æ­£ç¡®
- [ ] å¯†ç æ­£ç¡®åŠ å¯†
- [ ] æ— æ•æ„Ÿä¿¡æ¯æ³„éœ²

### 4. ç”¨æˆ·ä½“éªŒæµ‹è¯•
- [ ] ç§»åŠ¨ç«¯é€‚é…æ­£å¸¸
- [ ] é”™è¯¯æç¤ºå‹å¥½
- [ ] åŠ è½½åŠ¨ç”»æµç•…
- [ ] å¤šè¯­è¨€åˆ‡æ¢æ­£å¸¸

---

## ç›‘æ§å’Œç»´æŠ¤

### 1. è®¾ç½®ç›‘æ§
- [ ] é…ç½® Vercel Analytics (å…è´¹)
- [ ] è®¾ç½®é”™è¯¯è¿½è¸ª (Sentry)
- [ ] é…ç½® Uptime ç›‘æ§
- [ ] è®¾ç½®æ—¥å¿—æ”¶é›†

### 2. å¤‡ä»½ç­–ç•¥
- [ ] è®¾ç½®æ•°æ®åº“è‡ªåŠ¨å¤‡ä»½
- [ ] å®šæœŸå¯¼å‡ºç”¨æˆ·æ•°æ®
- [ ] å¤‡ä»½ç¯å¢ƒå˜é‡é…ç½®
- [ ] ä»£ç å®šæœŸæ¨é€åˆ° Git

### 3. æ›´æ–°è®¡åˆ’
- [ ] å®šæœŸæ›´æ–°ä¾èµ–åŒ…
- [ ] å®šæœŸæ›´æ¢ JWT å¯†é’¥
- [ ] å®šæœŸæ£€æŸ¥å®‰å…¨æ¼æ´
- [ ] å®šæœŸå®¡æŸ¥ç”¨æˆ·åé¦ˆ

---

## å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜ 1: éƒ¨ç½²æˆåŠŸä½†æ— æ³•è®¿é—®

**å¯èƒ½åŸå› :**
- DNS æœªç”Ÿæ•ˆ
- HTTPS è¯ä¹¦æœªé…ç½®
- é˜²ç«å¢™é˜»æ­¢

**è§£å†³æ–¹æ¡ˆ:**
```bash
# æ£€æŸ¥ DNS
nslookup your-domain.com

# æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€
curl -I https://your-domain.com
```

### é—®é¢˜ 2: ç”¨æˆ·æ— æ³•æ³¨å†Œ/ç™»å½•

**å¯èƒ½åŸå› :**
- æ•°æ®åº“æœªè¿æ¥
- JWT_SECRET æœªè®¾ç½®
- Cookie é…ç½®é”™è¯¯

**è§£å†³æ–¹æ¡ˆ:**
1. æ£€æŸ¥ç¯å¢ƒå˜é‡
2. æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—
3. æµ‹è¯•æ•°æ®åº“è¿æ¥
```bash
node scripts/init-database.js
```

### é—®é¢˜ 3: æ•°æ®åº“è¿æ¥å¤±è´¥

**å¯èƒ½åŸå› :**
- REDIS_URL é…ç½®é”™è¯¯
- Redis æœåŠ¡æœªå¯åŠ¨
- ç½‘ç»œé—®é¢˜

**è§£å†³æ–¹æ¡ˆ:**
```bash
# æµ‹è¯• Redis è¿æ¥
redis-cli -u $REDIS_URL ping

# æ£€æŸ¥ Redis çŠ¶æ€
redis-cli info
```

### é—®é¢˜ 4: API å“åº”æ…¢

**å¯èƒ½åŸå› :**
- æ•°æ®åº“æŸ¥è¯¢æ…¢
- æœåŠ¡å™¨èµ„æºä¸è¶³
- ç½‘ç»œå»¶è¿Ÿ

**è§£å†³æ–¹æ¡ˆ:**
1. å¯ç”¨ Redis ç¼“å­˜
2. ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢
3. å¢åŠ æœåŠ¡å™¨èµ„æº
4. ä½¿ç”¨ CDN

---

## å›æ»šè®¡åˆ’

å¦‚æœéƒ¨ç½²å‡ºç°ä¸¥é‡é—®é¢˜ï¼ŒæŒ‰ä»¥ä¸‹æ­¥éª¤å›æ»š:

### Vercel å›æ»š
1. åœ¨ Vercel Dashboard æ‰¾åˆ°é¡¹ç›®
2. ç‚¹å‡» "Deployments" æ ‡ç­¾
3. æ‰¾åˆ°ä¸Šä¸€ä¸ªç¨³å®šç‰ˆæœ¬
4. ç‚¹å‡»å³ä¾§ "..." èœå•
5. é€‰æ‹© "Promote to Production"

### Docker å›æ»š
```bash
# åœæ­¢å½“å‰ç‰ˆæœ¬
docker-compose down

# åˆ‡æ¢åˆ°ç¨³å®šç‰ˆæœ¬
git checkout <stable-commit>

# é‡æ–°éƒ¨ç½²
docker-compose up -d
```

---

## ç´§æ€¥è”ç³»ä¿¡æ¯

**æŠ€æœ¯æ”¯æŒ:**
- Email: support@citea.com
- GitHub Issues: [é¡¹ç›®ä»“åº“]

**æœåŠ¡æä¾›å•†:**
- Vercel Status: https://www.vercel-status.com/
- Upstash Status: https://status.upstash.com/
- OpenAI Status: https://status.openai.com/

---

## ä¸‹ä¸€æ­¥ä¼˜åŒ–

éƒ¨ç½²æˆåŠŸåï¼Œè€ƒè™‘ä»¥ä¸‹ä¼˜åŒ–:

### 1. æ€§èƒ½ä¼˜åŒ–
- [ ] æ·»åŠ  Redis ç¼“å­˜å±‚
- [ ] å¯ç”¨ CDN
- [ ] å›¾ç‰‡ä¼˜åŒ–
- [ ] ä»£ç åˆ†å‰²

### 2. åŠŸèƒ½å¢å¼º
- [ ] é‚®ä»¶éªŒè¯
- [ ] å¿˜è®°å¯†ç 
- [ ] ç¤¾äº¤ç™»å½•
- [ ] ç”¨æˆ·èµ„æ–™é¡µ

### 3. å•†ä¸šåŒ–
- [ ] é›†æˆæ”¯ä»˜ç³»ç»Ÿ (Stripe)
- [ ] å®ç°è®¢é˜…ç®¡ç†
- [ ] ä½¿ç”¨é‡ç»Ÿè®¡
- [ ] å‘ç¥¨ç”Ÿæˆ

### 4. ç”¨æˆ·ä½“éªŒ
- [ ] æ·»åŠ å¼•å¯¼æ•™ç¨‹
- [ ] å®Œå–„é”™è¯¯æç¤º
- [ ] æ·»åŠ å¸®åŠ©æ–‡æ¡£
- [ ] å®¢æœæ”¯æŒ

---

## æ£€æŸ¥æ¸…å•æ€»ç»“

### å¿…é¡»å®Œæˆ (Critical)
- âœ… ç¯å¢ƒå˜é‡é…ç½®
- âœ… æ•°æ®åº“è¿æ¥
- âœ… JWT å¯†é’¥è®¾ç½®
- âœ… HTTPS å¯ç”¨
- âœ… åŸºæœ¬åŠŸèƒ½æµ‹è¯•

### æ¨èå®Œæˆ (Recommended)
- â¬œ è‡ªå®šä¹‰åŸŸå
- â¬œ é”™è¯¯ç›‘æ§
- â¬œ æ€§èƒ½ä¼˜åŒ–
- â¬œ å¤‡ä»½ç­–ç•¥
- â¬œ æ–‡æ¡£å®Œå–„

### å¯é€‰å®Œæˆ (Optional)
- â¬œ é‚®ä»¶æœåŠ¡
- â¬œ æ”¯ä»˜é›†æˆ
- â¬œ ç¤¾äº¤ç™»å½•
- â¬œ åˆ†æå·¥å…·
- â¬œ SEO ä¼˜åŒ–

---

**æœ€åæ›´æ–°**: 2025-10-31
**ç‰ˆæœ¬**: 1.0.0

ç¥éƒ¨ç½²é¡ºåˆ©! ğŸ‰

